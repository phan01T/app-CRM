<div class="consent-wrapper">
  <h3>Consent (GDPR/PDPA)</h3>

  <!-- B·ªô l·ªçc -->
  <div class="filter-row">
    <select [(ngModel)]="filterEmail">
      <option>T·∫•t c·∫£</option>
      <option>C√≥</option>
      <option>Kh√¥ng</option>
    </select>

    <select [(ngModel)]="filterSms">
      <option>T·∫•t c·∫£</option>
      <option>C√≥</option>
      <option>Kh√¥ng</option>
    </select>

    <select [(ngModel)]="filterSource">
      <option>B·∫•t k·ª≥</option>
      <option>Form</option>
      <option>Email</option>
      <option>POS</option>
      <option>Chatbot</option>
    </select>

    <button class="btn-primary" (click)="toggleForm()">
      {{ showForm ? "ƒê√≥ng" : "T·∫°o consent" }}
    </button>
  </div>

  <!-- Form t·∫°o consent m·ªõi -->
  <div class="create-form" *ngIf="showForm">
    <h4>üßæ T·∫°o consent m·ªõi</h4>
    <div class="form-grid">
      <label>Kh√°ch h√†ng</label>
      <input
        [(ngModel)]="newConsent.name"
        name="name"
        placeholder="T√™n kh√°ch h√†ng"
      />

      <label>Email</label>
      <input
        [(ngModel)]="newConsent.email"
        name="email"
        placeholder="email@domain.com"
      />

      <label>Ngu·ªìn</label>
      <select [(ngModel)]="newConsent.source" name="source">
        <option value="">-- Ch·ªçn --</option>
        <option>Form</option>
        <option>Email</option>
        <option>POS</option>
        <option>Chatbot</option>
      </select>

      <label>Email opt-in</label>
      <select [(ngModel)]="newConsent.emailOptIn" name="emailOptIn">
        <option value="">-- Ch·ªçn --</option>
        <option>C√≥</option>
        <option>Kh√¥ng</option>
      </select>

      <label>SMS opt-in</label>
      <select [(ngModel)]="newConsent.smsOptIn" name="smsOptIn">
        <option value="">-- Ch·ªçn --</option>
        <option>C√≥</option>
        <option>Kh√¥ng</option>
      </select>

      <label>Th·ªùi ƒëi·ªÉm</label>
      <input
        [(ngModel)]="newConsent.time"
        name="time"
        type="text"
        placeholder="YYYY-MM-DD HH:mm"
      />
    </div>

    <div class="form-actions">
      <button class="secondary" (click)="toggleForm()">H·ªßy</button>
      <button class="primary" (click)="saveConsent()">L∆∞u consent</button>
    </div>
  </div>

  <!-- Th√¥ng b√°o -->
  <div *ngIf="successMsg" class="alert success">{{ successMsg }}</div>

  <!-- B·∫£ng danh s√°ch consent -->
  <table class="consent-table">
    <thead>
      <tr>
        <th>Kh√°ch h√†ng</th>
        <th>Ngu·ªìn</th>
        <th>Email opt-in</th>
        <th>SMS opt-in</th>
        <th>Th·ªùi ƒëi·ªÉm</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let c of consents">
        <td>
          <div class="customer">
            <div class="name">{{ c.name }}</div>
            <div class="email">{{ c.email }}</div>
          </div>
        </td>
        <td>{{ c.source }}</td>
        <td>{{ c.emailOptIn }}</td>
        <td>{{ c.smsOptIn }}</td>
        <td>{{ c.time }}</td>
      </tr>
    </tbody>
  </table>
</div>
